<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Performance Reviews - Payroll Management</title>
  <link rel="stylesheet" href="style.css">
  <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet">
  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
  <script>
    function logout(){ localStorage.removeItem('authToken'); localStorage.removeItem('userRole'); localStorage.removeItem('username'); localStorage.removeItem('fullName'); window.location.href='login.html'; }
    function checkAuth(){ const t=localStorage.getItem('authToken'); const r=localStorage.getItem('userRole'); const u=localStorage.getItem('username'); if(!t||!r||!u){ window.location.href='login.html'; return; } document.getElementById('currentUser').innerHTML=`<span>${localStorage.getItem('fullName') || u}</span><span class="role-badge">${r.toUpperCase()}</span>`; document.body.classList.add('employee-theme'); loadPerformanceData(); }
    
    let performanceChart = null;
    
    function loadPerformanceData() {
        const username = localStorage.getItem('username');
        const userRole = localStorage.getItem('userRole');
        
        loadPerformanceSummary(username);
        loadReviews(username);
        
        if (userRole === 'hr' || userRole === 'admin') {
            document.getElementById('hrControls').style.display = 'block';
            loadAllReviews();
        }
    }
    
    function loadPerformanceSummary(username) {
        const reviews = JSON.parse(localStorage.getItem(`reviews_${username}`) || '[]');
        
        if (reviews.length === 0) {
            // Generate demo performance data
            const demoReviews = [
                {
                    id: 1,
                    employeeId: localStorage.getItem('employeeId') || 'EMP0001',
                    employeeName: localStorage.getItem('fullName') || username,
                    period: 'Q4 2024',
                    overallScore: 4.2,
                    scores: {
                        communication: 4.5,
                        teamwork: 4.0,
                        problemSolving: 4.3,
                        productivity: 4.1,
                        leadership: 3.8
                    },
                    feedback: 'Excellent performance this quarter. Strong communication skills and great team collaboration.',
                    goals: [
                        'Improve leadership skills',
                        'Complete advanced training',
                        'Mentor new team members'
                    ],
                    status: 'Completed',
                    reviewDate: '2024-12-15',
                    reviewerName: 'Sarah Johnson (Manager)'
                },
                {
                    id: 2,
                    employeeId: localStorage.getItem('employeeId') || 'EMP0001',
                    employeeName: localStorage.getItem('fullName') || username,
                    period: 'Q3 2024',
                    overallScore: 3.9,
                    scores: {
                        communication: 4.0,
                        teamwork: 3.8,
                        problemSolving: 4.0,
                        productivity: 3.9,
                        leadership: 3.7
                    },
                    feedback: 'Good progress on goals from previous quarter. Continue focusing on leadership development.',
                    goals: [
                        'Enhance technical skills',
                        'Improve time management',
                        'Take on more responsibilities'
                    ],
                    status: 'Completed',
                    reviewDate: '2024-09-15',
                    reviewerName: 'Sarah Johnson (Manager)'
                }
            ];
            localStorage.setItem(`reviews_${username}`, JSON.stringify(demoReviews));
            displayPerformanceSummary(demoReviews);
            createPerformanceChart(demoReviews);
        } else {
            displayPerformanceSummary(reviews);
            createPerformanceChart(reviews);
        }
    }
    
    function displayPerformanceSummary(reviews) {
        if (reviews.length === 0) return;
        
        const latestReview = reviews[0];
        const avgScore = latestReview.overallScore;
        
        document.getElementById('currentScore').textContent = avgScore.toFixed(1);
        document.getElementById('scoreChange').textContent = reviews.length > 1 ? 
            `(${avgScore > reviews[1].overallScore ? '+' : ''}${(avgScore - reviews[1].overallScore).toFixed(1)} from last review)` : '';
        
        // Performance level
        let performanceLevel = 'Needs Improvement';
        let levelClass = 'danger';
        if (avgScore >= 4.0) {
            performanceLevel = 'Exceeds Expectations';
            levelClass = 'success';
        } else if (avgScore >= 3.0) {
            performanceLevel = 'Meets Expectations';
            levelClass = 'warning';
        }
        
        document.getElementById('performanceLevel').textContent = performanceLevel;
        document.getElementById('performanceLevel').className = `status-badge ${levelClass}`;
        
        // Goals progress
        const completedGoals = latestReview.goals ? latestReview.goals.length : 0;
        document.getElementById('goalsCompleted').textContent = completedGoals;
    }
    
    function createPerformanceChart(reviews) {
        const ctx = document.getElementById('performanceChart');
        if (!ctx) return;
        
        if (performanceChart) {
            performanceChart.destroy();
        }
        
        const latestReview = reviews[0];
        const categories = Object.keys(latestReview.scores);
        const scores = Object.values(latestReview.scores);
        
        performanceChart = new Chart(ctx, {
            type: 'radar',
            data: {
                labels: categories.map(cat => cat.charAt(0).toUpperCase() + cat.slice(1).replace(/([A-Z])/g, ' $1')),
                datasets: [{
                    label: latestReview.period,
                    data: scores,
                    borderColor: 'rgb(37, 99, 235)',
                    backgroundColor: 'rgba(37, 99, 235, 0.2)',
                    pointBackgroundColor: 'rgb(37, 99, 235)',
                    pointBorderColor: '#fff',
                    pointHoverBackgroundColor: '#fff',
                    pointHoverBorderColor: 'rgb(37, 99, 235)'
                }]
            },
            options: {
                responsive: true,
                scales: {
                    r: {
                        beginAtZero: true,
                        max: 5,
                        ticks: {
                            stepSize: 1
                        }
                    }
                },
                plugins: {
                    legend: {
                        display: false
                    }
                }
            }
        });
    }
    
    function loadReviews(username) {
        const reviews = JSON.parse(localStorage.getItem(`reviews_${username}`) || '[]');
        displayReviews(reviews);
    }
    
    function displayReviews(reviews) {
        const container = document.getElementById('reviewsContainer');
        
        if (reviews.length === 0) {
            container.innerHTML = '<div class="no-data">No performance reviews found</div>';
            return;
        }
        
        container.innerHTML = reviews.map(review => `
            <div class="review-card">
                <div class="review-header">
                    <div class="review-period">${review.period}</div>
                    <div class="review-score">
                        <span class="score-number">${review.overallScore.toFixed(1)}</span>
                        <span class="score-label">/ 5.0</span>
                    </div>
                </div>
                <div class="review-details">
                    <div class="reviewer">Reviewed by: ${review.reviewerName}</div>
                    <div class="review-date">Date: ${new Date(review.reviewDate).toLocaleDateString()}</div>
                    <div class="review-status">
                        <span class="status-badge ${review.status === 'Completed' ? 'success' : 'warning'}">${review.status}</span>
                    </div>
                </div>
                <div class="review-feedback">
                    <h5>Feedback:</h5>
                    <p>${review.feedback}</p>
                </div>
                ${review.goals && review.goals.length > 0 ? `
                    <div class="review-goals">
                        <h5>Goals for Next Period:</h5>
                        <ul>
                            ${review.goals.map(goal => `<li>${goal}</li>`).join('')}
                        </ul>
                    </div>
                ` : ''}
                <div class="review-actions">
                    <button class="secondary-btn small" onclick="viewReviewDetails(${review.id})">
                        <i class="fas fa-eye"></i> View Details
                    </button>
                </div>
            </div>
        `).join('');
    }
    
    function loadAllReviews() {
        const allReviews = [];
        const employees = JSON.parse(localStorage.getItem('employeeDirectory') || '[]');
        
        employees.forEach(employee => {
            const reviews = JSON.parse(localStorage.getItem(`reviews_${employee.username}`) || '[]');
            reviews.forEach(review => {
                allReviews.push({
                    ...review,
                    employeeName: employee.name,
                    employeeId: employee.employeeId
                });
            });
        });
        
        displayAllReviews(allReviews);
    }
    
    function displayAllReviews(reviews) {
        const tbody = document.getElementById('allReviewsBody');
        
        if (reviews.length === 0) {
            tbody.innerHTML = '<tr><td colspan="6" class="no-data">No performance reviews found</td></tr>';
            return;
        }
        
        tbody.innerHTML = reviews.sort((a, b) => new Date(b.reviewDate) - new Date(a.reviewDate)).map(review => `
            <tr>
                <td>${review.employeeName}</td>
                <td>${review.period}</td>
                <td>${review.overallScore.toFixed(1)}</td>
                <td>${new Date(review.reviewDate).toLocaleDateString()}</td>
                <td><span class="status-badge ${review.status === 'Completed' ? 'success' : 'warning'}">${review.status}</span></td>
                <td>
                    <button class="secondary-btn small" onclick="viewReviewDetails(${review.id}, '${review.employeeId}')">
                        <i class="fas fa-eye"></i> View
                    </button>
                    <button class="primary-btn small" onclick="createNewReview('${review.employeeId}')">
                        <i class="fas fa-plus"></i> New Review
                    </button>
                </td>
            </tr>
        `).join('');
    }
    
    function viewReviewDetails(reviewId, employeeId = null) {
        let review, employeeName;
        
        if (employeeId) {
            // HR viewing employee review
            const employees = JSON.parse(localStorage.getItem('employeeDirectory') || '[]');
            const emp = employees.find(e => e.employeeId === employeeId);
            if (!emp) return;
            
            const reviews = JSON.parse(localStorage.getItem(`reviews_${emp.username}`) || '[]');
            review = reviews.find(r => r.id === reviewId);
            employeeName = emp.name;
        } else {
            // Employee viewing own review
            const username = localStorage.getItem('username');
            const reviews = JSON.parse(localStorage.getItem(`reviews_${username}`) || '[]');
            review = reviews.find(r => r.id === reviewId);
            employeeName = localStorage.getItem('fullName') || localStorage.getItem('username');
        }
        
        if (!review) return;
        
        document.getElementById('detailEmployee').textContent = employeeName;
        document.getElementById('detailPeriod').textContent = review.period;
        document.getElementById('detailScore').textContent = review.overallScore.toFixed(1);
        document.getElementById('detailReviewer').textContent = review.reviewerName;
        document.getElementById('detailDate').textContent = new Date(review.reviewDate).toLocaleDateString();
        document.getElementById('detailFeedback').textContent = review.feedback;
        
        // Display category scores
        const scoresContainer = document.getElementById('categoryScores');
        scoresContainer.innerHTML = Object.entries(review.scores).map(([category, score]) => `
            <div class="score-item">
                <span class="score-category">${category.charAt(0).toUpperCase() + category.slice(1).replace(/([A-Z])/g, ' $1')}</span>
                <div class="score-bar">
                    <div class="score-fill" style="width: ${(score / 5) * 100}%"></div>
                </div>
                <span class="score-value">${score.toFixed(1)}</span>
            </div>
        `).join('');
        
        // Display goals
        const goalsContainer = document.getElementById('reviewGoals');
        if (review.goals && review.goals.length > 0) {
            goalsContainer.innerHTML = `
                <h5>Goals for Next Period:</h5>
                <ul>
                    ${review.goals.map(goal => `<li>${goal}</li>`).join('')}
                </ul>
            `;
        } else {
            goalsContainer.innerHTML = '<p>No goals set for this period.</p>';
        }
        
        document.getElementById('reviewDetailsModal').style.display = 'block';
    }
    
    function closeReviewDetailsModal() {
        document.getElementById('reviewDetailsModal').style.display = 'none';
    }
    
    function createNewReview(employeeId = null) {
        if (employeeId) {
            document.getElementById('newReviewEmployeeId').value = employeeId;
            loadEmployeesForReview();
        } else {
            document.getElementById('newReviewEmployeeId').value = '';
        }
        
        document.getElementById('newReviewModal').style.display = 'block';
    }
    
    function closeNewReviewModal() {
        document.getElementById('newReviewModal').style.display = 'none';
        document.getElementById('newReviewForm').reset();
    }
    
    function loadEmployeesForReview() {
        const employees = JSON.parse(localStorage.getItem('employeeDirectory') || '[]');
        const select = document.getElementById('newReviewEmployeeId');
        select.innerHTML = '<option value="">Select Employee...</option>' +
            employees.map(emp => `<option value="${emp.employeeId}">${emp.name} (${emp.employeeId})</option>`).join('');
    }
    
    function submitNewReview(e) {
        e.preventDefault();
        
        const formData = new FormData(e.target);
        const employees = JSON.parse(localStorage.getItem('employeeDirectory') || '[]');
        const selectedEmployee = employees.find(emp => emp.employeeId === formData.get('employeeId'));
        
        if (!selectedEmployee) {
            alert('Please select a valid employee');
            return;
        }
        
        const scores = {
            communication: parseFloat(formData.get('communication')),
            teamwork: parseFloat(formData.get('teamwork')),
            problemSolving: parseFloat(formData.get('problemSolving')),
            productivity: parseFloat(formData.get('productivity')),
            leadership: parseFloat(formData.get('leadership'))
        };
        
        const overallScore = Object.values(scores).reduce((sum, score) => sum + score, 0) / Object.values(scores).length;
        
        const review = {
            id: Date.now(),
            employeeId: formData.get('employeeId'),
            employeeName: selectedEmployee.name,
            period: formData.get('period'),
            overallScore: overallScore,
            scores: scores,
            feedback: formData.get('feedback'),
            goals: formData.get('goals').split('\n').filter(goal => goal.trim()),
            status: 'Completed',
            reviewDate: new Date().toISOString().split('T')[0],
            reviewerName: localStorage.getItem('fullName') || localStorage.getItem('username') + ' (Manager)'
        };
        
        const reviews = JSON.parse(localStorage.getItem(`reviews_${selectedEmployee.username}`) || '[]');
        reviews.unshift(review);
        localStorage.setItem(`reviews_${selectedEmployee.username}`, JSON.stringify(reviews));
        
        closeNewReviewModal();
        loadPerformanceData();
        
        // Add activity
        addActivity(`Created performance review for ${selectedEmployee.name}`, 'Success');
        
        alert('Performance review created successfully!');
    }
    
    function addActivity(action, status) {
        const username = localStorage.getItem('username');
        const activity = {
            date: new Date().toLocaleDateString(),
            action: action,
            status: status
        };
        
        const activities = JSON.parse(localStorage.getItem(`activities_${username}`) || '[]');
        activities.unshift(activity);
        localStorage.setItem(`activities_${username}`, JSON.stringify(activities.slice(0, 50)));
    }
    
    // Close modals when clicking outside
    window.onclick = function(event) {
        const modals = [
            document.getElementById('newReviewModal'),
            document.getElementById('reviewDetailsModal')
        ];
        modals.forEach(modal => {
            if (event.target === modal) {
                modal.style.display = 'none';
            }
        });
    }
    
    document.addEventListener('DOMContentLoaded', checkAuth);
  </script>
  <style>
    .performance-summary {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
      gap: 20px;
      margin-bottom: 30px;
    }
    .summary-card {
      background: var(--card);
      border: 1px solid var(--border);
      border-radius: var(--radius);
      padding: 20px;
      text-align: center;
      box-shadow: var(--shadow);
    }
    .summary-card h4 {
      margin: 0 0 10px;
      color: var(--muted);
      font-size: 0.9rem;
    }
    .summary-card .score {
      font-size: 2.5rem;
      font-weight: bold;
      color: var(--primary);
    }
    .summary-card .change {
      font-size: 0.9rem;
      color: var(--muted);
      margin-top: 5px;
    }
    .chart-container {
      background: var(--card);
      border: 1px solid var(--border);
      border-radius: var(--radius);
      padding: 20px;
      margin-bottom: 30px;
      box-shadow: var(--shadow);
    }
    .review-card {
      background: var(--card);
      border: 1px solid var(--border);
      border-radius: var(--radius);
      padding: 20px;
      margin-bottom: 20px;
      box-shadow: var(--shadow);
    }
    .review-header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-bottom: 15px;
    }
    .review-period {
      font-size: 1.2rem;
      font-weight: 600;
      color: var(--text);
    }
    .review-score {
      text-align: right;
    }
    .score-number {
      font-size: 2rem;
      font-weight: bold;
      color: var(--primary);
    }
    .score-label {
      color: var(--muted);
      font-size: 0.9rem;
    }
    .review-details {
      display: flex;
      gap: 20px;
      margin-bottom: 15px;
      font-size: 0.9rem;
      color: var(--muted);
    }
    .review-feedback h5,
    .review-goals h5 {
      margin: 0 0 8px;
      color: var(--text);
      font-size: 0.9rem;
    }
    .review-feedback p {
      margin: 0 0 15px;
      line-height: 1.5;
    }
    .review-goals ul {
      margin: 0;
      padding-left: 20px;
    }
    .review-goals li {
      margin-bottom: 5px;
    }
    .score-item {
      display: flex;
      align-items: center;
      gap: 15px;
      margin-bottom: 10px;
    }
    .score-category {
      min-width: 120px;
      font-size: 0.9rem;
    }
    .score-bar {
      flex: 1;
      height: 8px;
      background: #e5e7eb;
      border-radius: 4px;
      overflow: hidden;
    }
    .score-fill {
      height: 100%;
      background: var(--primary);
      transition: width 0.3s ease;
    }
    .score-value {
      min-width: 30px;
      text-align: right;
      font-weight: 600;
      color: var(--primary);
    }
    @media (max-width: 768px) {
      .performance-summary {
        grid-template-columns: 1fr;
      }
      .review-header {
        flex-direction: column;
        align-items: flex-start;
        gap: 10px;
      }
      .review-details {
        flex-direction: column;
        gap: 5px;
      }
      .score-item {
        flex-direction: column;
        align-items: flex-start;
        gap: 5px;
      }
      .score-category {
        min-width: auto;
      }
    }
  </style>
</head>
<body>
  <header class="header">
    <div class="header-content">
      <h1><i class="fas fa-chart-line"></i> Performance Reviews</h1>
      <div class="user-info">
        <span id="currentUser">Loading...</span>
        <button onclick="logout()" class="logout-btn"><i class="fas fa-sign-out-alt"></i> Logout</button>
      </div>
    </div>
  </header>
  
  <div class="container">
    <nav class="sidebar">
      <div class="sidebar-header"><i class="fas fa-user-tie"></i><span>Employee Portal</span></div>
      <ul class="nav-links">
        <li><a href="employee-dashboard.html"><i class="fas fa-tachometer-alt"></i><span>Dashboard</span></a></li>
        <li><a href="employee-reports.html"><i class="fas fa-file-alt"></i><span>My Reports</span></a></li>
        <li><a href="employee-profile.html"><i class="fas fa-user-cog"></i><span>Profile</span></a></li>
        <li><a href="time-tracking.html"><i class="fas fa-clock"></i><span>Time Tracking</span></a></li>
        <li><a href="employee-directory.html"><i class="fas fa-users"></i><span>Directory</span></a></li>
        <li><a href="leave-management.html"><i class="fas fa-calendar-alt"></i><span>Leave</span></a></li>
        <li><a href="shift-scheduling.html"><i class="fas fa-calendar-alt"></i><span>Shifts</span></a></li>
        <li><a href="expense-reimbursement.html"><i class="fas fa-receipt"></i><span>Expenses</span></a></li>
        <li class="active"><a href="performance-reviews.html"><i class="fas fa-chart-line"></i><span>Performance</span></a></li>
      </ul>
    </nav>
    
    <main class="main-content">
      <div class="page-header">
        <h2><i class="fas fa-chart-line"></i> Performance Reviews</h2>
        <p>Track your performance and receive feedback.</p>
      </div>
      
      <!-- Performance Summary -->
      <div class="performance-summary">
        <div class="summary-card">
          <h4>Current Score</h4>
          <div class="score" id="currentScore">0.0</div>
          <div class="change" id="scoreChange"></div>
        </div>
        <div class="summary-card">
          <h4>Performance Level</h4>
          <div class="status-badge" id="performanceLevel">-</div>
        </div>
        <div class="summary-card">
          <h4>Goals Completed</h4>
          <div class="score" id="goalsCompleted">0</div>
        </div>
      </div>
      
      <!-- Performance Chart -->
      <div class="chart-container">
        <h3><i class="fas fa-chart-radar"></i> Performance Breakdown</h3>
        <canvas id="performanceChart" width="400" height="200"></canvas>
      </div>
      
      <!-- My Reviews -->
      <div class="content-section">
        <div class="section-header">
          <h3><i class="fas fa-file-alt"></i> My Performance Reviews</h3>
        </div>
        <div id="reviewsContainer">
          <!-- Reviews will be populated here -->
        </div>
      </div>
      
      <!-- HR Controls (only visible for HR/Admin) -->
      <div id="hrControls" class="content-section" style="display: none;">
        <div class="section-header">
          <h3><i class="fas fa-users-cog"></i> All Performance Reviews</h3>
          <button onclick="createNewReview()" class="primary-btn">
            <i class="fas fa-plus"></i> New Review
          </button>
        </div>
        <div class="table-container">
          <table class="data-table">
            <thead>
              <tr>
                <th>Employee</th>
                <th>Period</th>
                <th>Score</th>
                <th>Review Date</th>
                <th>Status</th>
                <th>Actions</th>
              </tr>
            </thead>
            <tbody id="allReviewsBody">
              <!-- Data will be populated here -->
            </tbody>
          </table>
        </div>
      </div>
    </main>
  </div>
  
  <footer><p>&copy; 2025 PayrollPro by Aaron | Performance Reviews</p></footer>
  
  <!-- New Review Modal -->
  <div id="newReviewModal" class="modal">
    <div class="modal-content" style="max-width: 800px;">
      <div class="modal-header">
        <h3><i class="fas fa-plus"></i> New Performance Review</h3>
        <span class="close" onclick="closeNewReviewModal()">&times;</span>
      </div>
      <form id="newReviewForm" onsubmit="submitNewReview(event)">
        <div class="form-grid">
          <div class="form-group">
            <label for="newReviewEmployeeId">Employee</label>
            <select name="employeeId" id="newReviewEmployeeId" required>
              <option value="">Select Employee...</option>
            </select>
          </div>
          <div class="form-group">
            <label for="period">Review Period</label>
            <input type="text" name="period" placeholder="e.g., Q1 2025" required>
          </div>
        </div>
        
        <h4>Performance Ratings (1-5 scale)</h4>
        <div class="form-grid">
          <div class="form-group">
            <label for="communication">Communication</label>
            <select name="communication" required>
              <option value="">Select rating...</option>
              <option value="1">1 - Needs Improvement</option>
              <option value="2">2 - Below Expectations</option>
              <option value="3">3 - Meets Expectations</option>
              <option value="4">4 - Exceeds Expectations</option>
              <option value="5">5 - Outstanding</option>
            </select>
          </div>
          <div class="form-group">
            <label for="teamwork">Teamwork</label>
            <select name="teamwork" required>
              <option value="">Select rating...</option>
              <option value="1">1 - Needs Improvement</option>
              <option value="2">2 - Below Expectations</option>
              <option value="3">3 - Meets Expectations</option>
              <option value="4">4 - Exceeds Expectations</option>
              <option value="5">5 - Outstanding</option>
            </select>
          </div>
          <div class="form-group">
            <label for="problemSolving">Problem Solving</label>
            <select name="problemSolving" required>
              <option value="">Select rating...</option>
              <option value="1">1 - Needs Improvement</option>
              <option value="2">2 - Below Expectations</option>
              <option value="3">3 - Meets Expectations</option>
              <option value="4">4 - Exceeds Expectations</option>
              <option value="5">5 - Outstanding</option>
            </select>
          </div>
          <div class="form-group">
            <label for="productivity">Productivity</label>
            <select name="productivity" required>
              <option value="">Select rating...</option>
              <option value="1">1 - Needs Improvement</option>
              <option value="2">2 - Below Expectations</option>
              <option value="3">3 - Meets Expectations</option>
              <option value="4">4 - Exceeds Expectations</option>
              <option value="5">5 - Outstanding</option>
            </select>
          </div>
          <div class="form-group">
            <label for="leadership">Leadership</label>
            <select name="leadership" required>
              <option value="">Select rating...</option>
              <option value="1">1 - Needs Improvement</option>
              <option value="2">2 - Below Expectations</option>
              <option value="3">3 - Meets Expectations</option>
              <option value="4">4 - Exceeds Expectations</option>
              <option value="5">5 - Outstanding</option>
            </select>
          </div>
        </div>
        
        <div class="form-group">
          <label for="feedback">Feedback</label>
          <textarea name="feedback" rows="4" placeholder="Provide detailed feedback on performance..." required></textarea>
        </div>
        
        <div class="form-group">
          <label for="goals">Goals for Next Period (one per line)</label>
          <textarea name="goals" rows="3" placeholder="Goal 1&#10;Goal 2&#10;Goal 3"></textarea>
        </div>
        
        <div class="modal-actions">
          <button type="button" onclick="closeNewReviewModal()" class="secondary-btn">Cancel</button>
          <button type="submit" class="primary-btn">Create Review</button>
        </div>
      </form>
    </div>
  </div>
  
  <!-- Review Details Modal -->
  <div id="reviewDetailsModal" class="modal">
    <div class="modal-content" style="max-width: 800px;">
      <div class="modal-header">
        <h3><i class="fas fa-eye"></i> Review Details</h3>
        <span class="close" onclick="closeReviewDetailsModal()">&times;</span>
      </div>
      <div class="modal-grid">
        <div class="modal-field">
          <label>Employee</label>
          <span id="detailEmployee">-</span>
        </div>
        <div class="modal-field">
          <label>Period</label>
          <span id="detailPeriod">-</span>
        </div>
        <div class="modal-field">
          <label>Overall Score</label>
          <span id="detailScore">-</span>
        </div>
        <div class="modal-field">
          <label>Reviewer</label>
          <span id="detailReviewer">-</span>
        </div>
        <div class="modal-field">
          <label>Review Date</label>
          <span id="detailDate">-</span>
        </div>
      </div>
      
      <div class="modal-field">
        <label>Feedback</label>
        <span id="detailFeedback">-</span>
      </div>
      
      <h4>Category Scores</h4>
      <div id="categoryScores">
        <!-- Category scores will be populated here -->
      </div>
      
      <div id="reviewGoals">
        <!-- Goals will be populated here -->
      </div>
      
      <div class="modal-actions">
        <button onclick="closeReviewDetailsModal()" class="primary-btn">Close</button>
      </div>
    </div>
  </div>
</body>
</html>